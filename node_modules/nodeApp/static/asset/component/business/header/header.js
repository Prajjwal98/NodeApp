/*
* header组件
*/
if (typeof require != 'undefined') {
    require('./header.scss');
}

(function(){
    /*
    * 初始化变量
    */
    var $header = $('header'), $meanu = $header.find('.avatar-dropdown'), $ico = $header.find('.avatar-tip i.fa');

    /*
    * 定义事件
    */
    $header.find('.avatar-tip').on('click', function(e){
        $meanu.toggle();
        $ico.toggleClass('fa-angle-down fa-angle-up');
        // 阻止冒泡
        e.stopPropagation();
    });

    $meanu.find('a').on('click', function(e){
        pickUpMenu();
        // 阻止冒泡
        e.stopPropagation();
    });

    $(document.body).on('click', function(){
        pickUpMenu();
    });

    /*
    * 收起菜单栏
    */
    var pickUpMenu = function(){
        $meanu.hide();
        $ico.removeClass('fa-angle-up').addClass('fa-angle-down');
    }

    /*
    * 选中当前nav
    */

    var $nav, href,  navs = $header.find('.content .text-right > a');
    for(var i = 0, len = navs.length; i < len; i++){
        $nav = navs.eq(i), href = $nav.attr('href').toLowerCase(), name = location.pathname.toLowerCase();
        if(href === name || (href !== '/' && name.indexOf(href.substring(0, href.length - 1)) !== -1 )){
            $nav.addClass('active');
            break;
        }
    }
})();